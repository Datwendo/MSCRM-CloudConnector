MSCRM-CloudConnector
====================

The MS CRM (Online and On Premise) Solution to share data with Datwendo's Cloud Connector

Datwendo Cloud Connector for Microsoft Dynamics CRM 
License New BSD (BSD)
Instructions

This plugin could be installed directly from our Datwendo Solution but you may also register or update it independently (beware that it won’t run if the Connector Entity is not created, which will only be done by importing the Datwendo solution).
The solution does not take care of registering the Steps for the plugin and you need to apply steps in this documentation before using the Cloud Connector Service.

The Plugin assembly contain 2 pluggins:
-	Datwendo.Crm.Sdk.ConnectorPlugin which acces the REST Service
-	Datwendo.Crm.Sdk.InsertConnectorPlugin which insert new values in CRM Attribute

Each time you want to use a Cloud Connector for an entity, you must:
1)	Create a Connector record in the Connector entity, menu placed under the Parameters Menu.
a.	Input The Id, Secret Key, Service Url, Protocol sent to you by Datwendo after your purchase of a Connector Service (or from the 14 days free demo)
b.	Input the logical name (lowercase, no space) of the CRM entity which will use this Connector (ex: account)
c.	Input the logical name (lowercase, no space) of the attribute  in this entity where the index value generated by Datwendo Service will be written on Create (ex: accountnumber)
2)	Register a new Step for Datwendo.Crm.Sdk.ConnectorPlugin Action Create, your Entity in Primary, with execution Order 1, Pre-operation, Sync and Server Deployment
3)	Register a new Step for Datwendo.Crm.Sdk.InsertConnectorPlugin same parameters but with Execution Order 10 

(sample for account) 

  
If you want up update the plugin from its source code, open the plug-in project and build the plug-in sample assembly
1.	Load DTW-CRM2011-plug-ins.sln into Visual Studio 2012.
2.	In Visual Studio, select Release, build the solution by pointing to Build, and then click Build Solution or just press F6.

Register or Update the assembly and plug-in

1.	Launch the Plugin Registration tool (in the bin folder of MS CRM Sdk).
2.	In the Plugin Registration tool’s “Connection” dialog, enter your Microsoft Dynamics CRM server information and click the Connect button.
3.	Enter a password when prompted to.
4.	Select an organization in the list and click the Connect button again or just double click an organization in the list.
5.	If the plugin is not already there, select Register and then click Register New Assembly, else select the plugin in the tree and select Update from right button menu
6.	In the Register New Plugin or Update form, click the ellipses … button under Step #1, navigate to the bin\Release folder of the plug-in project, and select the plug-in assembly DatwendoMSCRMPlugins.dll.
7.	Verify that Select All, Sandbox, and Database are checked. Click Register Selected Plugins.

Registering the Steps
1.	In the Registered Plugins & Custom Workflow Activities tree view, select the plug-in DatwendoMSCRMPlugins
2.	Select Register and then click Register New Step.
3.	In the Register New Step dialog, enter the registration parameters:
Message: Create
Primary Entity: [your entity]
Execution Mode: Synchronous
Event Pipeline Stage of Execution: Pre Operation
Step Deployment: Server
4.	Verify that the Plugin field value is set to the plug-in type. Datwendo.Crm.Sdk.ConnectorPlugin or Datwendo.Crm.Sdk.InsertConnectorPlugin
5.	Click Register New Step.
6.	The step is now registered. You can close the tool.


